<% if (username_signed_in?) %><% useridname = current_username.id %>
  <% if Visitor.find_by(idregvis: useridname) %>
    <h2><%= Visitor.find_by(idreg: useridname).name %>, вы уже добавили данные</h2>
    <p>Для просмотра информации нажмите вкладку "Профиль".</p>
  <% else %>
  <h1>Добавить личные данные</h1>
  <%= form_with scope: :visitor, html: { multipart:  true }, url: visitors_path, local: true do |form| %>
    <p>
      <%= form.label :"Аватарка" %><br>
      <%= form.file_field :photo %>
    </p>
      <p>
        <%= form.label :"Имя" %><br>
        <%= form.text_field :name %>
      </p>
      <p>
        <%= form.label :"Фамилия" %><br>
        <%= form.text_field :surname %>
      </p>
      <p>
        <%= form.label :"Пол" %><br>
        <%= form.select(:sex, [['Муж.', "Муж."], ['Жен.', "Жен."]]) %>
      </p>
      <p>
        <%= form.label :"Телефон" %><br>
        <%= form.text_field :telephone %>
      </p>
      <p>
        <%= form.label :"Страна" %><br>
        <%= form.text_field :country %>
      </p>
      <p>
        <%= form.label :"Город" %><br>
        <%= form.text_field :city %>
      </p>
      <p>
        <%= form.label :"Дата рождения" %><br>
        <%= form.date_field :birthdate %>
      </p>
      <p>
        <%= form.label :"Промокод" %><br>
        <%= form.text_field :promocode %>
      </p>
      <input type="hidden" name="visitor[idregvis]" id="visitor_idregvis" value="<% if (username_signed_in?) %><%= current_username.id %><% end %>">
      <p>
        <%= form.submit "Сохранить" %>
      </p>
    <% end %>
  <% end %>
<% end %>
